// -*- go -*-
//
// Copyright (c) 2025 Markku Rossi
//
// All rights reserved.
//

package main

import (
	"encoding/binary"
	"ephemelier/kernel"
	"ephemelier/memory"
	"ephemelier/memory/semihonest"
)

func main(g, e memory.PeerInit) ([]byte, kernel.PC, kernel.Syscall, int32) {

	_ = intern(Init)

	motd := []byte("Ephemelier v0.0 - Copyright (c) 2025 Markku Rossi\r\n")

	var nonce [semihonest.NonceSize]byte
	var mem [16]byte

	mem = binary.PutUint32(mem, 0, 0)
	mem = binary.PutUint32(mem, 4, 1)
	mem = binary.PutUint32(mem, 8, 20)

	return semihonest.Encode(nonce, mem, g.key, e.key), intern(StFibo),
		kernel.SysContinue, 0
}
